import pandas as pd

def extract_table(file_path, headers):
    # Read the CSV file
    df = pd.read_csv(file_path, header=None)
    
    # Find the header row index
    header_row_idx = None
    for idx, row in df.iterrows():
        if list(row[:len(headers)]) == headers:
            header_row_idx = idx
            break
    
    if header_row_idx is None:
        raise ValueError("Header row not found")
    
    # Read the table data from the header row onwards
    table_df = pd.read_csv(file_path, skiprows=header_row_idx)
    
    return table_df

# Path to the CSV file
file_path = 'path_to_your_file.csv'

# Headers we are looking for
headers = ["IP", "Network", "DNS", "NetBIOS"]

# Extracting the table
table_df = extract_table(file_path, headers)

# Saving the extracted table to a new CSV file
output_file_path = 'extracted_table.csv'
table_df.to_csv(output_file_path, index=False)

print(f"Table extracted and saved to {output_file_path}")

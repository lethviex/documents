import requests
import time

api_url = "your_api_url_here"
max_running_time = 30 * 60  # 30 minutes in seconds
query_interval = 5 * 60  # 5 minutes in seconds

start_time = time.time()

while True:
    # Query the API
    response = requests.get(api_url)
    
    if response.status_code == 200:
        # Check the status in the API response
        status = response.json().get('status')

        # Check if the status is 'running'
        if status == 'running':
            elapsed_time = time.time() - start_time

            # Check if it has been running for more than 30 minutes
            if elapsed_time >= max_running_time:
                print("Task has been running for more than 30 minutes. Exiting.")
                break
            else:
                print(f"Task is still running. Elapsed time: {elapsed_time} seconds.")
        else:
            print(f"Task status is not 'running'. Exiting.")
            break
    else:
        print(f"Failed to query the API. Status code: {response.status_code}. Exiting.")
        break

    # Wait for the next query interval
    time.sleep(query_interval)

# Replace 'username' with the AD username for which you want to export the group membership.
$UserName = "username"

# Get the user's group membership
$Groups = Get-ADUser -Identity $UserName -Properties MemberOf | Select-Object -ExpandProperty MemberOf

# Convert Distinguished Names (DNs) of groups to Group Names
$GroupNames = foreach ($Group in $Groups) {
    (Get-ADGroup -Identity $Group).Name
}

# Export group names to a CSV file
$GroupNames | Export-Csv -Path "C:\Path\To\Output\ADUserGroups.csv" -NoTypeInformation

Write-Host "Group membership of $UserName has been exported to C:\Path\To\Output\ADUserGroups.csv"
